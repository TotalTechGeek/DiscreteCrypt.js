<h1>DiscreteCrypt.js Browser Test</h1>
<hr>
<p style=" overflow-wrap: break-word;" id="out"></p>
<script type="text/javascript" src="build/discretecrypt.js"></script>
<script>
    let d = new Date()

    // The scrypt tuned down due to the random 256 bit key space.

    // These are far, far less than the default parameters.
    // There is little need for the Scrypt step when standard brute-force is less expensive. 
    // The scrypt step is still somewhat valuable, due to the HMAC (used as salt) making it difficult
    // to change anything.   
    const scryptConfig = {
        N: 1 << 10,
        r: 4,
        p: 1,
        len: 32
    }
   
    function output(x)
    {
        document.getElementById('out').innerHTML += x + "<br><br>"
    }

    Promise.all([
        DiscreteCrypt.Contact.create(null, null, scryptConfig),
        DiscreteCrypt.Contact.create(null, null, scryptConfig)
    ]).then(([
        jesse,
        jerry
    ]) =>
    {
        DiscreteCrypt.exchange(jesse, jerry, { master: 'This is a master password', organization_id: '1'}).then(data =>
        {
            output(JSON.stringify(data))
            DiscreteCrypt.open(jerry, data).then(i=>output(JSON.stringify(i))).then(() =>
            {
                let y = new Date()
                output(y-d + ' ms')
            }).catch(output)
        })
    })
</script>

